name: barreled_workspace
publish_to: none

environment:
  sdk: ^3.6.1

workspace:
  - packages/barreled
  - packages/barreled_annotation
  - tools/lints

dev_dependencies:
  melos: ^7.0.0-dev.7

melos:
  repository: https://github.com/jnnkmsr/barreled
  sdkPath: auto
  ide:
    intellij:
      enable: true
      moduleNamePrefix: ''

  command:
    version:
      branch: develop
      includeScopes: false
      workspaceChangelog: false
      message: |
        chore: automated versioning
        
        {new_package_versions}

    bootstrap:
      runPubGetInParallel: true
      runPutGetOffline: false
      enforceLockfile: false

      environment:
        sdk: ^3.6.1
      dependencies:
        analyzer: ^6.11.0
        build: ^2.4.2
        collection: ^1.19.0
        dart_style: ^2.3.7
        file: ^7.0.1
        glob: ^2.1.3
        json_annotation: ^4.9.0
        meta: ^1.15.0
        path: ^1.9.0
        source_gen: ^1.5.0
        yaml: ^3.1.3
      dev_dependencies:
        build_runner: ^2.4.14
        build_test: ^2.2.3
        json_serializable: ^6.9.0
        mocktail: ^1.0.4
        test: ^1.25.8
        very_good_analysis: ^7.0.0

  # Semantic prefixes and icons:
  #   ğŸ“¦ build - Tasks related to compiling and building artifacts.
  #   ğŸ§¹ clean - Removing generated files, caches, and resetting the workspace.
  #   ğŸš€ deploy - CI/CD and publishing-related tasks.
  #   ğŸ¨ format - Formatting code, enforcing style rules, and static analysis.
  #   ğŸ—ï¸ generate - Code generation and boilerplate creation.
  #   ğŸ·ï¸ release - Managing versions, releases, and changelogs.
  #   ğŸ“Š report - Generating reports and coverage metrics.
  #   âš™ï¸ setup - Setup, initialization, and configuration.
  #   ğŸ§ª test - Running unit, integration, and UI tests.
  #   ğŸ› ï¸ tools - Other utility scripts not fitting elsewhere.
  scripts:
    clean:build_runner_cache:
      description: |
        ğŸ§¹ Clean the `build_runner` cache for a selected package.
      exec: |
        dart run build_runner clean
      packageFilters:
        dependsOn: build_runner

    generate:build_runner:
      description: |
        ğŸ—ï¸ Run `build_runner` for a selected package.
      exec: |
        dart run build_runner build -d
      packageFilters:
        dependsOn: build_runner
