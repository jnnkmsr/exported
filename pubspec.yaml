name: barreled_workspace
publish_to: none

environment:
  sdk: ^3.6.1

workspace:
  - packages/barreled_annotation
  - packages/barreled_generator
  - tools/lints

dev_dependencies:
  melos: ^7.0.0-dev.7

melos:
  repository: https://github.com/jnnkmsr/barreled
  sdkPath: auto
  ide:
    intellij:
      enable: true
      moduleNamePrefix: ''

  command:
    version:
      branch: develop
      includeScopes: false
      workspaceChangelog: false
      message: |
        chore: automated versioning
        
        {new_package_versions}

    bootstrap:
      runPubGetInParallel: true
      runPutGetOffline: false
      enforceLockfile: false

      environment:
        sdk: ^3.6.1
      dependencies:
      dev_dependencies:
        very_good_analysis: ^7.0.0

  # Semantic prefixes and icons:
  #   ğŸ“¦ build - Tasks related to compiling and building artifacts.
  #   ğŸ§¹ clean - Removing generated files, caches, and resetting the workspace.
  #   ğŸš€ deploy - CI/CD and publishing-related tasks.
  #   ğŸ¨ format - Formatting code, enforcing style rules, and static analysis.
  #   ğŸ—ï¸ generate - Code generation and boilerplate creation.
  #   ğŸ·ï¸ release - Managing versions, releases, and changelogs.
  #   ğŸ“Š report - Generating reports and coverage metrics.
  #   âš™ï¸ setup - Setup, initialization, and configuration.
  #   ğŸ§ª test - Running unit, integration, and UI tests.
  #   ğŸ› ï¸ tools - Other utility scripts not fitting elsewhere.
  scripts:
    clean:build_runner_cache:
      description: |
        ğŸ§¹ Clean the `build_runner` cache for a selected package.
      exec: |
        dart run build_runner clean
      packageFilters:
        dependsOn: build_runner

    generate:build_runner:
      description: |
        ğŸ—ï¸ Run `build_runner` for a selected package.
      exec: |
        dart run build_runner build -d
      packageFilters:
        dependsOn: build_runner
